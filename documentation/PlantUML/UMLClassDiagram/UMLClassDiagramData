@startuml
left to right direction
skinparam packageStyle rectangle
title Data Package

package "data" {

  ' File-based classes next
  class FileBasedTrailRepo {
    + FileBasedTrailRepo(csvFilePath : String)
    - loadTrailsFromCSV(filePath : String) : List<Trail>
    + getAllTrails() : List<Trail>
    + findById(id : int) : Optional<Trail>
    + countTrails() : int
  }

  class FileBasedKeywordRepo {
    + FileBasedKeywordRepo(filePath : String)
    - loadKeywordsFromCSV(filePath : String) : Map<String, List<String>>
  }

  class DatabaseService {
      + DatabaseService()
      + DatabaseService(databasePath : String)
      + getConnection() : Connection
      + databaseExists() : boolean
      + deleteDatabase() : boolean
      + createDatabaseIfNotExists() : void
      + isSchemaUpToDate() : boolean
    }

  ' QueryHelper placed before SQL classes to reduce backtracking
  class QueryHelper {
    + QueryHelper(databaseService : DatabaseService)
    + executeQuery(sql : String, paramSetter : ParameterSetter, rowMapper : RowMapper) : List
    + executeUpdate(sql : String, paramSetter : ParameterSetter) : int
  }

  ' SQL-based classes follow
  class SqlBasedTrailRepo {
    + SqlBasedTrailRepo(databaseService : DatabaseService)
    + getAllTrails() : List<Trail>
    + getRecommendedTrails() : List<Trail>
    + findById(id : int) : Optional<Trail>
    + upsert(trail : Trail) : void
    + deleteById(id : int) : void
  }

  class SqlBasedKeywordRepo {
    + SqlBasedKeywordRepo(databaseService : DatabaseService)
    + getKeywords() : Map<String, List<String>>
  }

  class SqlBasedTrailLogRepo {
    + SqlBasedTrailLogRepo(databaseService : DatabaseService)
    + getAllTrailLogs() : List<TrailLog>
    + findById(id : int) : Optional<TrailLog>
    + deleteById(id : int) : void
    + upsert(trailLog : TrailLog) : void
  }

  class SqlBasedFilterOptionsRepo {
    + SqlBasedFilterOptionsRepo(databaseService : DatabaseService)
    + getFilterOptions(filterType : String) : List<String>
    + refreshAllFilterOptions()
    + refreshRegionOptions()
  }
}


' Dependencies to QueryHelper
SqlBasedTrailRepo     *-- QueryHelper
SqlBasedKeywordRepo   *-- QueryHelper
SqlBasedTrailLogRepo     *-- QueryHelper
SqlBasedFilterOptionsRepo *-- QueryHelper

SqlBasedTrailRepo ..> DatabaseService
SqlBasedKeywordRepo ..> DatabaseService
SqlBasedTrailLogRepo ..> DatabaseService
SqlBasedFilterOptionsRepo ..> DatabaseService

QueryHelper ..> DatabaseService

@enduml